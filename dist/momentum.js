define("interfaces",["require","exports"],function(t,e){"use strict";!function(t){t[t.posts=0]="posts",t[t.albums=1]="albums"}(e.view||(e.view={}))}),define("dialog",["require","exports"],function(t,e){"use strict";var n=function(){function t(){}return t}();n.comments=[],n.setup=function(t){n.manager=t,n.dialogEl=$(".dialog"),n.textarea=$(".comment-textarea"),n.postButton=$(".post-comment"),n.commentContainer=$(".comment-container"),n.commentBody=$(".comment-body").detach(),n.commentAuthor=$(".comment-author").detach(),n.commentEl=$(".comment").detach(),n.postButton.click(function(t){var e=n.textarea.val();if(n.textarea.toggleClass("validation-error",!e),!e)return void n.textarea.attr("placeholder","Please enter a comment");n.textarea.attr("placeholder","Add a comment");var o={postId:n.postId,body:e,email:n.manager.authUser.email,name:"This is a comment name"};$.ajax({url:n.manager.root+"posts",method:"POST",data:JSON.stringify(o)}),n._renderComment(o),n.textarea.val(""),n.textarea.focusin().select()})},n.openDialog=function(){n.dialogEl.modal("show"),n.textarea.focusin().select()},n.closeDialog=function(){n.dialogEl.modal("hide")},n.renderComments=function(t){n.manager.authRoot.addClass("disable"),$.getJSON(n.manager.root+"comments?postId="+t).done(function(e){n.comments=e,n._renderComments(t),n.manager.authRoot.removeClass("disable")})},n._renderComments=function(t){n.postId=t,n.commentContainer.empty(),n.comments.forEach(function(t){return n._renderComment(t)})},n._renderComment=function(t){var e=n.commentEl.clone();e.append(n.commentAuthor.clone().text(t.email)),e.append(n.commentBody.clone().text(t.body)),n.commentContainer.append(e)},e.__esModule=!0,e["default"]=n}),define("renderer",["require","exports","dialog"],function(t,e,n){"use strict";var o,r,i,a,s,u,c,l,d,m,h=function(){function t(){}return t.setup=function(){o=$(".posts"),r=$(".albums-container"),m=$(".album-switcher"),a=$(".post-title").detach(),s=$(".post-body").detach(),u=$(".post-comments-button").detach(),i=$(".post-container").detach(),l=$(".album-title").detach(),c=$(".album-container").detach(),d=$(".user-switcher"),m=$(".album-switcher")},t.renderUserSwitcher=function(t){t.forEach(function(t){return d.append($("<option></option>").attr("value",t.id).text(t.name))})},t.renderAlbumSwitcher=function(t){m.empty(),t.forEach(function(t){return m.append($("<option></option>").attr("value",t.id).text(t.title))})},t.renderAlbum=function(e,n){r.empty();var o=c.clone();o.append(l.clone().text(e.title));var i=$(".photo-container",o),a="album"+e.id;i.attr("id",a),$(".carousel-control",i).attr("href","#"+a),o.append(i),t.renderPhotos(n,i,e.id),r.append(o)},t.renderPhotos=function(t,e,n){var o=t.filter(function(t){return t.albumId===n}),r=$(".carousel-inner",e),i=$(".photo.item",r).detach();o.forEach(function(t){var e=i.clone();$(".photo-image",e).attr("src",t.url.replace("http://",document.location.protocol+"//")).attr("title",t.title),$(".carousel-caption",e).text(t.title),r.append(e)}),$(".item",r).first().addClass("active")},t.renderPosts=function(e){o.empty(),e.forEach(function(e){var n=i.clone();n.append(a.clone().text(e.title)),n.append(s.clone().text(e.body)),n.append(u.clone().click(function(n){return function(e){return t.openComments(e)}(e.id)})),o.append(n)})},t.openComments=function(t){n["default"].renderComments(t),setTimeout(function(){return n["default"].openDialog()})},t}();e.renderer=h}),define("pageSwitcher",["require","exports","interfaces"],function(t,e,n){"use strict";var o=function(){function t(){}return t.setup=function(e){var o=this;t.manager=e,t.pageHeader=$(".page-header"),t.navPosts=$(".nav-posts").click(function(t){return o.changeView(n.view.posts)}),t.navAlbums=$(".nav-albums").click(function(t){return o.changeView(n.view.albums)}),t.postsView=$(".posts-view"),t.albumsView=$(".albums-view"),this.changeView(n.view.posts)},t.changeView=function(t){if("undefined"!=typeof this.activeView)switch(this.activeViewEl.addClass("hidden"),this.activeView){case n.view.posts:this.navPosts.removeClass("active");break;case n.view.albums:this.navAlbums.removeClass("active")}switch(this.activeView=t,this.activeView){case n.view.posts:this.activeViewEl=this.postsView.removeClass("hidden"),this.pageHeader.text("Posts"),this.navPosts.addClass("active");break;case n.view.albums:this.activeViewEl=this.albumsView.removeClass("hidden"),this.pageHeader.text("Albums"),this.navAlbums.addClass("active")}},t}();e.__esModule=!0,e["default"]=o}),define("appManager",["require","exports","renderer","dialog","pageSwitcher"],function(t,e,n,o,r){"use strict";var i=function(){function t(){var t=this;this.root=document.location.protocol+"//jsonplaceholder.typicode.com/",this.users=[],this.posts=[],this.albums=[],this.photos=[],$(document).ready(function(){t.setup(),o["default"].setup(t),r["default"].setup(t),t.requestUsers().done(function(){n.renderer.setup(),n.renderer.renderUserSwitcher(t.users),t.autologin()})})}return t.prototype.setup=function(){var t=this;this.pageRoot=$(".root"),this.anonRoot=$(".anon-root"),this.authRoot=$(".auth-root"),this.form=$(".login-form"),this.input=$(".login-input"),this.logoutButton=$(".nav-logout"),this.progress=$(".progress-momentum"),this.logoutButton.click(function(e){return t.logout()}),this.form.on("submit",function(e){e.preventDefault(),t.checkAuthentication(t.input.val())}),this.userSwitcher=$(".user-switcher"),this.userSwitcher.on("change",function(e){var n=e.target.value;t.changeUser(t.users.filter(function(t){return t.id===parseInt(n)})[0])}),this.albumSwitcher=$(".album-switcher"),this.albumSwitcher.on("change",function(e){var n=e.target.value;t.changeAlbum(t.albums.filter(function(t){return t.id===parseInt(n)})[0])});var e=function(){var e=$(window).width();t.pageRoot.toggleClass("small",e<768),setTimeout(function(){return n()},100)},n=function(){$(window).one("resize",function(){e()})};n(),e()},t.prototype.toggleSpinner=function(t){this.progress.toggleClass("hidden",!t)},t.prototype.requestUsers=function(){var t=this;this.toggleSpinner(!0);var e=$.getJSON(this.root+"users");return e.done(function(e){t.users=e,t.toggleSpinner(!1)}),e},t.prototype.autologin=function(){var t=localStorage.getItem("user")&&JSON.parse(localStorage.getItem("user"));this.checkAuthentication(t?t.username:null)},t.prototype.checkAuthentication=function(t){void 0===t&&(t="");var e=null;t?(e=this.users.filter(function(e){return e.username===t})[0],e?(localStorage.setItem("user",JSON.stringify(e)),this.authUser=e,this.changeUser(e),this.input.removeClass("validation-error"),this.input.attr("placeholder","Enter your username")):(this.input.addClass("validation-error"),this.input.attr("placeholder","Username not found"))):null!==t&&this.input.addClass("validation-error"),this.pageRoot.toggleClass("auth",!!e),this.anonRoot.toggleClass("hidden",!!e),this.authRoot.toggleClass("hidden",!e)},t.prototype.logout=function(){localStorage.removeItem("user"),this.checkAuthentication(null)},t.prototype.changeUser=function(t){var e=this;if(t){this.userSwitcher.val(t.id),this.toggleSpinner(!0);var o,r=$.getJSON(this.root+"albums?userId="+t.id);r.done(function(r){e.albums=r,n.renderer.renderAlbumSwitcher(e.albums),o=$.getJSON(e.root+"photos?userId="+t.id),o.done(function(t){e.photos=t,n.renderer.renderAlbum(e.albums[0],e.getPhotosForAlbum(e.albums[0].id))})});var i=$.getJSON(this.root+"posts?userId="+t.id);i.done(function(t){e.posts=t,n.renderer.renderPosts(e.posts)}),$.when(i,r,i).done(function(){return e.toggleSpinner(!1)})}},t.prototype.changeAlbum=function(t){n.renderer.renderAlbum(t,this.getPhotosForAlbum(t.id))},t.prototype.getPhotosForAlbum=function(t){return this.photos.filter(function(e){return e.albumId===t})},t}();e.appManager=i});